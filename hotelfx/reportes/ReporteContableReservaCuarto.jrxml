<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.12.2.final using JasperReports Library version 6.12.2-75c5e90a222ab406e416cbf590a5397028a52de3  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Blank_A4_1" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="047091a0-0eca-4c5f-8669-682f4504f278">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="Data1"/>
	<parameter name="FechaI" class="java.sql.Date"/>
	<parameter name="FechaF" class="java.sql.Date"/>
	<queryString language="SQL">
		<![CDATA[select 
if(rc.idReservaCuarto is not null, "Ingreso Reserva cuarto", "") as TIPO,
            c.idCliente as Cliente,
            rc.senia as Ganancia,
            DATE_FORMAT(rc.fechaIngreso, '%V') as Semana,
            DATE_FORMAT(rc.fechaIngreso, '%m') as Mes,
            DATE_FORMAT(rc.fechaIngreso, '%Y-%m-%d') as Fecha
from cliente c
inner join reservacuarto rc on rc.idCliente = c.idCliente
where  DATE_FORMAT(rc.fechaIngreso, '%Y-%m-%d')  >= $P{FechaI} and  DATE_FORMAT(rc.fechaIngreso, '%Y-%m-%d') <= $P{FechaF} 
union
select 
if(rc.idReservaCuarto is not null, "Egreso Reserva cuarto", "") as TIPO,
            c.idCliente as Cliente,
            rc.MontoReservaCuarto as Ganancia,
            DATE_FORMAT(rc.fechaEgreso, '%V') as Semana,
            DATE_FORMAT(rc.fechaEgreso, '%m') as Mes,
            DATE_FORMAT(rc.fechaEgreso, '%Y-%m-%d') as Fecha
from cliente c
inner join reservacuarto rc on rc.idCliente = c.idCliente
where  DATE_FORMAT(rc.fechaEgreso, '%Y-%m-%d') >= $P{FechaI} and  DATE_FORMAT(rc.fechaEgreso, '%Y-%m-%d')<= $P{FechaF} 
union
select 
if(re.idReservaEvento is not null, "Reserva evento", "") as TIPO,
            c.idCliente as Cliente,
            re.montoReservaEvento as Ganancia,
            DATE_FORMAT(re.fechaInicioReserva, '%V') as Semana,
            DATE_FORMAT(re.fechaInicioReserva, '%m') as Mes,
            DATE_FORMAT(re.fechaInicioReserva, '%Y-%m-%d') as Fecha
from cliente c
inner join reservaevento re on re.idCliente = c.idCliente
where   DATE_FORMAT(re.fechaInicioReserva, '%Y-%m-%d') >= $P{FechaI} and   DATE_FORMAT(re.fechaInicioReserva, '%Y-%m-%d') <= $P{FechaF} 
union
select 
if(op.idOrdenPedido is not null and ti.fechaReserva is not null, "Pedido Reserva", "Pedido") as TIPO,
            c.idCliente as Cliente,
            op.PrecioTotal as Ganancia,
            DATE_FORMAT(ti.fechaReserva, '%V') as Semana,
            DATE_FORMAT(ti.fechaReserva, '%m') as Mes,
		DATE_FORMAT(ti.fechaReserva, '%Y-%m-%d') as Fecha
from cliente c
inner join ordenpedido op on op.idCliente = c.idCliente
inner join ticket ti on op.idCliente = ti.idCliente
where  	DATE_FORMAT(ti.fechaReserva, '%Y-%m-%d') >= $P{FechaI} and  	DATE_FORMAT(ti.fechaReserva, '%Y-%m-%d') <= $P{FechaF} 
order by Fecha
]]>
	</queryString>
	<field name="TIPO" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="TIPO"/>
	</field>
	<field name="Cliente" class="java.lang.Integer">
		<property name="com.jaspersoft.studio.field.label" value="Cliente"/>
	</field>
	<field name="Ganancia" class="java.math.BigDecimal">
		<property name="com.jaspersoft.studio.field.label" value="Ganancia"/>
	</field>
	<field name="Semana" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="Semana"/>
	</field>
	<field name="Mes" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="Mes"/>
	</field>
	<field name="Fecha" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.label" value="Fecha"/>
	</field>
	<variable name="SumadorTipos" class="java.math.BigDecimal" resetType="Group" resetGroup="Tipos" calculation="Sum">
		<variableExpression><![CDATA[$F{Ganancia}]]></variableExpression>
	</variable>
	<variable name="SumDiario" class="java.math.BigDecimal" resetType="Group" resetGroup="Dia" calculation="Sum">
		<variableExpression><![CDATA[$F{Ganancia}]]></variableExpression>
		<initialValueExpression><![CDATA[$F{Ganancia}]]></initialValueExpression>
	</variable>
	<variable name="SumSemanal" class="java.math.BigDecimal" resetType="Group" resetGroup="Semana" calculation="Sum">
		<variableExpression><![CDATA[$F{Ganancia}]]></variableExpression>
	</variable>
	<variable name="SumMes" class="java.math.BigDecimal" resetType="Group" resetGroup="Mes" calculation="Sum">
		<variableExpression><![CDATA[$F{Ganancia}]]></variableExpression>
	</variable>
	<group name="Mes">
		<groupExpression><![CDATA[$F{Mes}]]></groupExpression>
		<groupFooter>
			<band height="62">
				<textField>
					<reportElement x="490" y="32" width="100" height="30" uuid="9f690598-fac0-431c-9ab5-47bdf1d2efb1"/>
					<textFieldExpression><![CDATA[$V{SumMes}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="Semana">
		<groupExpression><![CDATA[$F{Semana}]]></groupExpression>
		<groupFooter>
			<band height="45">
				<textField>
					<reportElement x="400" y="7" width="100" height="30" uuid="21eea6cd-c743-4e91-ac45-407b06d6f625"/>
					<textFieldExpression><![CDATA[$V{SumSemanal}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="Dia">
		<groupExpression><![CDATA[$F{Fecha}]]></groupExpression>
		<groupFooter>
			<band height="30">
				<textField>
					<reportElement x="290" y="-5" width="100" height="30" uuid="6bde7158-9bfc-42da-9e81-02fe80b60adf"/>
					<textFieldExpression><![CDATA[$V{SumDiario}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="Tipos">
		<groupExpression><![CDATA[$F{TIPO}]]></groupExpression>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="79" splitType="Stretch"/>
	</title>
	<pageHeader>
		<band height="35" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="76" splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="53" splitType="Stretch">
			<textField>
				<reportElement x="200" y="0" width="100" height="30" uuid="89dbeedb-15cf-4c70-868f-425afadc9a07"/>
				<textFieldExpression><![CDATA[$F{Ganancia}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="100" y="0" width="100" height="30" uuid="499759a9-3e9b-4c62-b9ca-5143a167c166"/>
				<textFieldExpression><![CDATA[$F{TIPO}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="0" y="-2" width="100" height="30" uuid="1f057b34-073d-4cc0-a328-b6d809921a55"/>
				<textFieldExpression><![CDATA[$F{Fecha}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="53" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="235" splitType="Stretch">
			<pieChart>
				<chart evaluationTime="Report">
					<reportElement x="180" y="10" width="200" height="200" uuid="e75d68df-7497-42ed-8ae0-c74c6372cdba"/>
					<chartTitle/>
					<chartSubtitle/>
					<chartLegend/>
				</chart>
				<pieDataset>
					<dataset resetType="Group" resetGroup="Tipos"/>
					<pieSeries>
						<keyExpression><![CDATA[$F{TIPO}]]></keyExpression>
						<valueExpression><![CDATA[$V{SumadorTipos}]]></valueExpression>
					</pieSeries>
					<pieSeries>
						<keyExpression><![CDATA[$F{Fecha}]]></keyExpression>
						<valueExpression><![CDATA[$V{SumadorTipos}]]></valueExpression>
					</pieSeries>
					<pieSeries>
						<keyExpression><![CDATA[$F{TIPO}]]></keyExpression>
						<valueExpression><![CDATA[$V{SumadorTipos}]]></valueExpression>
						<labelExpression><![CDATA[$V{SumadorTipos}]]></labelExpression>
					</pieSeries>
				</pieDataset>
				<piePlot>
					<plot/>
					<itemLabel/>
				</piePlot>
			</pieChart>
		</band>
	</pageFooter>
	<summary>
		<band height="42" splitType="Stretch"/>
	</summary>
</jasperReport>
